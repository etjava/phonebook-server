webpackJsonp([1],{"5htO":function(e,t){},BjtM:function(e,t){},I1MA:function(e,t){},MYYK:function(e,t){},NHnr:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("7+uW"),a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("keep-alive",{attrs:{exclude:"Detail"}},[t("router-view")],1)],1)},staticRenderFns:[]};var r=o("VU/8")({name:"App"},a,!1,function(e){o("I1MA")},null,null).exports,s=o("/ocq"),i=o("mtWM"),l=o.n(i);function c(e){return"http://localhost:80/"+e}var h={name:"Login",data:function(){return{userName:"",password:"",errorInfo:""}},methods:{submit:function(){var e=this,t=c("login");console.log(t),""!=this.userName.trim()?""!=this.password.trim()?l.a.post("apis/login",{userName:this.userName,password:this.password}).then(function(t){0==t.data.code?(console.log(t.data.token),window.localStorage.setItem("token",t.data.token),e.$router.replace("/phoneBook")):e.errorInfo=t.data.msg}).catch(function(t){e.errorInfo=t}):this.errorInfo="密码不能为空！":this.errorInfo="用户名不能为空！"}}},d={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"login-logo"},[e._v("通讯录")]),e._v(" "),o("form",{staticClass:"login-cont",attrs:{action:""}},[o("ul",[o("li",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.userName,expression:"userName"}],attrs:{type:"text",placeholder:"请输入用户名："},domProps:{value:e.userName},on:{input:function(t){t.target.composing||(e.userName=t.target.value)}}})]),e._v(" "),o("li",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",placeholder:"请输入密码："},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})])]),e._v(" "),o("a",{staticClass:"submitButton",attrs:{href:"javascript:;"},on:{click:function(t){return e.submit()}}},[e._v("登  录")]),e._v(" "),o("p",{staticClass:"errorInfo"},[e._v(e._s(e.errorInfo))])]),e._v(" "),e._m(0)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticClass:"copyright"},[this._v("\n    Copyright © 2012-2022 "),t("a",{attrs:{href:"#"}},[this._v("www.etjava.com")])])}]};var m=o("VU/8")(h,d,!1,function(e){o("hHO9")},"data-v-48f8114c",null).exports,p={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[this._v("\n  通讯录\n  "),t("router-link",{staticClass:"iconfont add-icon",attrs:{tag:"div",to:"/add"}},[this._v("")])],1)},staticRenderFns:[]};var u=o("VU/8")({name:"Header"},p,!1,function(e){o("MYYK")},"data-v-fb503e82",null).exports,v=o("r+/8"),f={name:"Search",data:function(){return{keyword:"",list:[]}},methods:{getImageUrl:function(e){return"/apis/image/"+e}},props:{phoneBooks:Object},watch:{keyword:function(){var e=this;if(this.keyword){var t=[];for(var o in this.phoneBooks)this.phoneBooks[o].forEach(function(o){o.name.indexOf(e.keyword)>-1&&t.push(o)});this.list=t}else this.list=[]}},mounted:function(){this.scroll=new v.a(this.$refs.search)}},k={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"search"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.keyword,expression:"keyword"}],staticClass:"search-input",attrs:{type:"text",placeholder:"搜索"},domProps:{value:e.keyword},on:{input:function(t){t.target.composing||(e.keyword=t.target.value)}}})]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.keyword,expression:"keyword"}],ref:"search",staticClass:"search-content"},[o("div",[e._l(e.list,function(t){return o("div",{key:t.id,staticClass:"item"},[o("img",{attrs:{src:e.getImageUrl(t.image)}}),e._v(" "),o("div",{staticClass:"content border-bottom"},[e._v(e._s(t.name))])])}),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!e.list.length,expression:"!list.length"}],staticClass:"item center"},[e._v("\n        没有找到匹配数据\n      ")])],2)])])},staticRenderFns:[]};var g=o("VU/8")(f,k,!1,function(e){o("5htO")},"data-v-20b56856",null).exports,B={name:"List",props:{phoneBooks:Object,letter:String},methods:{getImageUrl:function(e){return"/apis/image/"+e}},mounted:function(){this.scroll=new v.a(this.$refs.wrapper,{click:!0})},watch:{letter:function(){if(this.letter){var e=this.$refs[this.letter][0];this.scroll.scrollToElement(e)}}}},_={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{ref:"wrapper",staticClass:"list"},[o("div",e._l(e.phoneBooks,function(t,n){return o("div",{key:n,ref:n,refInFor:!0,staticClass:"phoneBook"},[o("div",{staticClass:"title"},[e._v(e._s(n))]),e._v(" "),e._l(t,function(t){return o("router-link",{key:t.id,staticClass:"item",attrs:{tag:"div",to:"/detail/"+t.id}},[o("img",{attrs:{src:e.getImageUrl(t.image)}}),e._v(" "),o("div",{staticClass:"content border-bottom"},[e._v(e._s(t.name))])])})],2)}),0)])},staticRenderFns:[]};var w=o("VU/8")(B,_,!1,function(e){o("vM8p")},"data-v-8e73f570",null).exports,b={name:"Alphabet",props:{phoneBooks:Object},data:function(){return{touchStatus:!1,startY:0,timer:null}},computed:{letters:function(){var e=[];for(var t in this.phoneBooks)e.push(t);return e}},methods:{handleLetterClick:function(e){console.log(e.target.innerText),this.$emit("change",e.target.innerText)},handleTouchStart:function(){this.touchStatus=!0,console.log("开始滑动")},handleTouchMove:function(e){var t=this;console.log("move"),this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){if(t.touchStatus){var o=e.touches[0].clientY-79,n=Math.floor((o-t.startY)/20);n>=0&&n<t.letters.length&&t.$emit("change",t.letters[n])}},20)},handleTouchEnd:function(){this.touchStatus=!1,console.log("结束滑动")}},updated:function(){this.startY=this.$refs.A[0].offsetTop}},C={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ul",{staticClass:"list"},e._l(e.letters,function(t,n){return o("li",{key:t,ref:t,refInFor:!0,staticClass:"item",on:{click:e.handleLetterClick,touchstart:e.handleTouchStart,touchmove:e.handleTouchMove,touchend:e.handleTouchEnd}},[e._v(e._s(t))])}),0)},staticRenderFns:[]};var y=o("VU/8")(b,C,!1,function(e){o("qJmG")},"data-v-faf59352",null).exports,N=o("x9pK"),I=o.n(N),x={name:"PhoneBook",components:{PhoneHeader:u,PhoneSearch:g,PhoneList:w,PhoneBookAlphabet:y},data:function(){return{phoneBooks:{},letter:""}},methods:{getPhoneBooks:function(){var e=this;console.log(c("phoneBook"));var t=window.localStorage.getItem("token");l.a.defaults.headers.common.token=t,l.a.get("apis/phoneBook/all").then(function(t){e.phoneBooks=t.data.data}).catch(function(t){e.errorInfo=t})},refreshToken:function(){var e=this,t=window.localStorage.getItem("token");l.a.defaults.headers.common.token=t,l.a.get("apis/refresh").then(function(e){console.log("token刷新返回的 "+e.data.token),window.localStorage.setItem("token",e.data.token)}).catch(function(t){e.errorInfo=t})},handleLetterChange:function(e){console.log("传递过来的字母  "+e),this.letter=e}},mounted:function(){var e=this;setInterval(this.refreshToken,6e5),this.getPhoneBooks(),I.a.subscribe("refreshPhoneBook",function(t,o){console.log("收到消息 refreshPhoneBook"),e.getPhoneBooks()})}},$={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("phone-header"),e._v(" "),o("phone-search",{attrs:{phoneBooks:e.phoneBooks}}),e._v(" "),o("phone-list",{attrs:{letter:e.letter,phoneBooks:e.phoneBooks}}),e._v(" "),o("phone-book-alphabet",{attrs:{phoneBooks:e.phoneBooks},on:{change:e.handleLetterChange}})],1)},staticRenderFns:[]};var A=o("VU/8")(x,$,!1,function(e){o("QIdc")},"data-v-6d143236",null).exports,P=o("bOdI"),G=o.n(P),S={name:"Gallery",props:{galleryImage:String},methods:{hideClick:function(){this.$emit("hideGalleryClick")}}},T={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container",on:{click:this.hideClick}},[t("div",{staticClass:"wrapper"},[t("img",{attrs:{src:this.galleryImage,alt:""}})])])},staticRenderFns:[]};var U=o("VU/8")(S,T,!1,function(e){o("xRIe")},"data-v-660f173b",null).exports,j={name:"Add",data:function(){return{phoneBook:{image:"default.jpg"},showGallery:!1,galleryImage:""}},components:{Gallery:U},methods:{getImageUrl:function(e){return c("image/"+e)},imageClick:function(){this.$refs.file.click()},showGalleryClick:function(){this.galleryImage=c("image/"+this.phoneBook.image),this.showGallery=!0},hideGalleryClick:function(){this.showGallery=!1},addInfo:function(){var e=this,t=c("phoneBook/save"),o=window.localStorage.getItem("token");if(l.a.defaults.headers.common.token=o,null!=this.phoneBook.name&&""!=this.phoneBook.name.trim())if(null!=this.phoneBook.phoneNumber&&""!=this.phoneBook.phoneNumber.trim()){if(/^1[3456789]\d{9}$/.test(this.phoneBook.phoneNumber))return null==this.phoneBook.teleNumber||""==this.phoneBook.teleNumber.trim()||/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/.test(this.phoneBook.teleNumber)?void l.a.post(t,G()({name:this.phoneBook.name,phoneNumber:this.phoneBook.phoneNumber,teleNumber:this.phoneBook.teleNumber,workAddress:this.phoneBook.workAddress,homeAddress:this.phoneBook.homeAddress,image:this.phoneBook.image,remark:this.phoneBook.remark},"image",this.phoneBook.image)).then(function(t){0==t.data.code?(alert("添加成功"),I.a.publish("refreshPhoneBook",""),e.$router.replace("/phoneBook")):alert(t.data.msg)}).catch(function(e){alert(e)}):(alert("固定电话有误，请重填"),!1);alert("手机号码有误，请重填")}else alert("手机号码不为空！");else alert("姓名不为空！")},upload:function(e){var t=this,o=e.target.files[0],n=new FormData;n.append("file",o,o.name),console.log(n.get("file"));var a=window.localStorage.getItem("token"),r=c("uploadImage"),s={headers:{"Content-Type":"multipart/form-data",token:a}};l.a.post(r,n,s).then(function(e){0==e.data.code&&(t.phoneBook.image=e.data.data.title)}).catch(function(e){console.log(e)})}}},E={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"detail"},[o("div",{staticClass:"header"},[o("router-link",{staticClass:"iconfont",attrs:{tag:"div",to:"/phoneBook"}},[e._v("")])],1),e._v(" "),o("div",{staticClass:"image"},[o("div",{staticClass:"info"},[o("img",{attrs:{src:e.getImageUrl(e.phoneBook.image)},on:{click:e.showGalleryClick}})]),e._v(" "),o("div",{staticClass:"action"},[o("button",{on:{click:e.imageClick}},[e._v("修改头像")]),e._v(" "),o("input",{ref:"file",attrs:{type:"file",name:"file",accept:"image/png,image/gif,image/jpeg,image/jpg"},on:{change:e.upload}})])]),e._v(" "),o("div",{staticClass:"userInfo"},[o("div",{staticClass:"item border-bottom"},[o("span",[e._v("姓名")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.name,expression:"phoneBook.name"}],attrs:{type:"text"},domProps:{value:e.phoneBook.name},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"name",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("手机号码")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.phoneNumber,expression:"phoneBook.phoneNumber"}],attrs:{type:"text"},domProps:{value:e.phoneBook.phoneNumber},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"phoneNumber",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("座机电话号码")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.teleNumber,expression:"phoneBook.teleNumber"}],attrs:{type:"text"},domProps:{value:e.phoneBook.teleNumber},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"teleNumber",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("工作单位地址")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.workAddress,expression:"phoneBook.workAddress"}],domProps:{value:e.phoneBook.workAddress},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"workAddress",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("家庭地址")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.homeAddress,expression:"phoneBook.homeAddress"}],domProps:{value:e.phoneBook.homeAddress},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"homeAddress",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("备注")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.remark,expression:"phoneBook.remark"}],domProps:{value:e.phoneBook.remark},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"remark",t.target.value)}}})])]),e._v(" "),o("div",{staticClass:"action"},[o("div",{staticClass:"item border-bottom"},[o("a",{on:{click:e.addInfo}},[e._v("保存")])])]),e._v(" "),o("gallery",{directives:[{name:"show",rawName:"v-show",value:e.showGallery,expression:"showGallery"}],attrs:{galleryImage:e.galleryImage},on:{hideGalleryClick:e.hideGalleryClick}})],1)},staticRenderFns:[]};var F=o("VU/8")(j,E,!1,function(e){o("sODC")},"data-v-cdf12a5c",null).exports,M={name:"Detail",data:function(){return{phoneBook:{image:"default.jpg"},showGallery:!1,galleryImage:""}},components:{Gallery:U},methods:{getImageUrl:function(e){return c("image/"+e)},imageClick:function(){this.$refs.file.click()},showGalleryClick:function(){this.galleryImage=c("image/"+this.phoneBook.image),this.showGallery=!0},hideGalleryClick:function(){this.showGallery=!1},delInfo:function(){var e=this;if(confirm("确定要删除吗？")){var t=c("phoneBook/delete"),o=window.localStorage.getItem("token");l.a.defaults.headers.common.token=o,l.a.get(t,{params:{id:this.phoneBook.id}}).then(function(t){0==t.data.code?(alert("删除成功"),I.a.publish("refreshPhoneBook",""),e.$router.replace("/phoneBook")):alert(t.data.msg)}).catch(function(e){alert(e)})}},updateInfo:function(){var e=this,t=c("phoneBook/save"),o=window.localStorage.getItem("token");if(l.a.defaults.headers.common.token=o,null!=this.phoneBook.name&&""!=this.phoneBook.name.trim())if(null!=this.phoneBook.phoneNumber&&""!=this.phoneBook.phoneNumber.trim()){if(/^1[3456789]\d{9}$/.test(this.phoneBook.phoneNumber))return null==this.phoneBook.teleNumber||""==this.phoneBook.teleNumber.trim()||/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/.test(this.phoneBook.teleNumber)?void l.a.post(t,G()({id:this.phoneBook.id,name:this.phoneBook.name,phoneNumber:this.phoneBook.phoneNumber,teleNumber:this.phoneBook.teleNumber,workAddress:this.phoneBook.workAddress,homeAddress:this.phoneBook.homeAddress,image:this.phoneBook.image,remark:this.phoneBook.remark},"image",this.phoneBook.image)).then(function(t){0==t.data.code?(alert("修改成功"),I.a.publish("refreshPhoneBook",""),e.$router.replace("/phoneBook")):alert(t.data.msg)}).catch(function(e){alert(e)}):(alert("固定电话有误，请重填"),!1);alert("手机号码有误，请重填")}else alert("手机号码不为空！");else alert("姓名不为空！")},upload:function(e){var t=this,o=e.target.files[0],n=new FormData;n.append("file",o,o.name),console.log(n.get("file"));var a=window.localStorage.getItem("token"),r=c("uploadImage"),s={headers:{"Content-Type":"multipart/form-data",token:a}};l.a.post(r,n,s).then(function(e){0==e.data.code&&(t.phoneBook.image=e.data.data.title)}).catch(function(e){console.log(e)})},getInfo:function(){var e=this,t=c("phoneBook/findById"),o=window.localStorage.getItem("token");l.a.defaults.headers.common.token=o,l.a.get(t,{params:{id:this.$route.params.id}}).then(function(t){e.phoneBook=t.data.phoneBook}).catch(function(e){alert(e)})}},mounted:function(){this.getInfo()}},O={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"detail"},[o("div",{staticClass:"header"},[o("router-link",{staticClass:"iconfont",attrs:{tag:"div",to:"/phoneBook"}},[e._v("")])],1),e._v(" "),o("div",{staticClass:"image"},[o("div",{staticClass:"info"},[o("img",{attrs:{src:e.getImageUrl(e.phoneBook.image)},on:{click:e.showGalleryClick}})]),e._v(" "),o("div",{staticClass:"action"},[o("button",{on:{click:e.imageClick}},[e._v("修改头像")]),e._v(" "),o("input",{ref:"file",attrs:{type:"file",name:"file",accept:"image/png,image/gif,image/jpeg,image/jpg"},on:{change:e.upload}})])]),e._v(" "),o("div",{staticClass:"userInfo"},[o("div",{staticClass:"item border-bottom"},[o("span",[e._v("姓名")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.name,expression:"phoneBook.name"}],attrs:{type:"text"},domProps:{value:e.phoneBook.name},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"name",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("手机号码")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.phoneNumber,expression:"phoneBook.phoneNumber"}],attrs:{type:"text"},domProps:{value:e.phoneBook.phoneNumber},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"phoneNumber",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("座机电话号码")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.teleNumber,expression:"phoneBook.teleNumber"}],attrs:{type:"text"},domProps:{value:e.phoneBook.teleNumber},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"teleNumber",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("工作单位地址")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.workAddress,expression:"phoneBook.workAddress"}],domProps:{value:e.phoneBook.workAddress},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"workAddress",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("家庭地址")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.homeAddress,expression:"phoneBook.homeAddress"}],domProps:{value:e.phoneBook.homeAddress},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"homeAddress",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("备注")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.remark,expression:"phoneBook.remark"}],domProps:{value:e.phoneBook.remark},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"remark",t.target.value)}}})])]),e._v(" "),o("div",{staticClass:"action"},[o("div",{staticClass:"item border-bottom"},[o("a",{on:{click:e.updateInfo}},[e._v("保存")])]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("a",{on:{click:e.delInfo}},[e._v("删除")])])]),e._v(" "),o("gallery",{directives:[{name:"show",rawName:"v-show",value:e.showGallery,expression:"showGallery"}],attrs:{galleryImage:e.galleryImage},on:{hideGalleryClick:e.hideGalleryClick}})],1)},staticRenderFns:[]};var R=o("VU/8")(M,O,!1,function(e){o("sXCT")},"data-v-3d503fd3",null).exports;n.a.use(s.a);var V=new s.a({routes:[{path:"/",name:"login",component:m},{path:"/phoneBook",name:A,component:A},{path:"/add",name:F,component:F},{path:"/detail/:id",name:R,component:R}]});o("m0iu"),o("cjdf"),o("BjtM");n.a.config.productionTip=!1,new n.a({el:"#app",router:V,components:{App:r},template:"<App/>"})},QIdc:function(e,t){},cjdf:function(e,t){},hHO9:function(e,t){},m0iu:function(e,t){},qJmG:function(e,t){},sODC:function(e,t){},sXCT:function(e,t){},vM8p:function(e,t){},xRIe:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.4020b534ca137248e193.js.map